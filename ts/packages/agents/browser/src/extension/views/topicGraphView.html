<!doctype html>
<!-- Copyright (c) Microsoft Corporation.
 Licensed under the MIT License. -->

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Topic Graph - TypeAgent</title>

    <link rel="stylesheet" href="../vendor/bootstrap/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
    />
    <script src="../vendor/cytoscape/cytoscape.min.js"></script>
    <script src="../vendor/dagre/dagre.min.js"></script>
    <script src="../vendor/cytoscape-dagre/cytoscape-dagre.min.js"></script>
    <link rel="stylesheet" href="topicGraphView.css" />
  </head>
  <body>
    <div class="topic-graph-container">
      <!-- Header -->
      <header class="topic-graph-header">
        <div class="header-left">
          <button id="backButton" class="btn btn-outline-secondary btn-sm">
            <i class="bi bi-arrow-left"></i> Back
          </button>
          <h1 class="header-title">Topic Graph</h1>
        </div>
        <div class="header-center">
          <div class="search-container">
            <input
              type="text"
              id="topicSearch"
              class="form-control"
              placeholder="Search topics..."
            />
            <button id="searchButton" class="btn btn-primary">
              <i class="bi bi-search"></i>
            </button>
          </div>
        </div>
        <div class="header-right">
          <div class="btn-group" role="group">
            <button
              id="treeViewBtn"
              class="btn btn-outline-primary active"
              data-mode="tree"
            >
              <i class="bi bi-diagram-3"></i> Tree
            </button>
            <button
              id="radialViewBtn"
              class="btn btn-outline-primary"
              data-mode="radial"
            >
              <i class="bi bi-circle"></i> Radial
            </button>
            <button
              id="forceViewBtn"
              class="btn btn-outline-primary"
              data-mode="force"
            >
              <i class="bi bi-arrows-move"></i> Force
            </button>
          </div>
          <button id="settingsButton" class="btn btn-outline-secondary">
            <i class="bi bi-gear"></i>
          </button>
        </div>
      </header>

      <!-- Main Content -->
      <div class="topic-graph-main">
        <!-- Sidebar -->
        <div class="topic-sidebar" id="topicSidebar">
          <div class="sidebar-header">
            <h5>Topic Details</h5>
            <button id="closeSidebar" class="btn btn-sm btn-outline-secondary">
              <i class="bi bi-x"></i>
            </button>
          </div>

          <div class="sidebar-content" id="sidebarContent">
            <div class="topic-placeholder">
              <i class="bi bi-bookmark"></i>
              <p>Select a topic to view details</p>
            </div>
          </div>

          <!-- Level Filter -->
          <div class="level-filter">
            <h6>Visible Levels</h6>
            <div class="level-checkboxes">
              <div class="form-check">
                <input
                  class="form-check-input level-checkbox"
                  type="checkbox"
                  value="0"
                  id="level0"
                  checked
                />
                <label class="form-check-label" for="level0">Root Topics</label>
              </div>
              <div class="form-check">
                <input
                  class="form-check-input level-checkbox"
                  type="checkbox"
                  value="1"
                  id="level1"
                  checked
                />
                <label class="form-check-label" for="level1">Sub Topics</label>
              </div>
              <div class="form-check">
                <input
                  class="form-check-input level-checkbox"
                  type="checkbox"
                  value="2"
                  id="level2"
                  checked
                />
                <label class="form-check-label" for="level2"
                  >Detail Topics</label
                >
              </div>
              <div class="form-check">
                <input
                  class="form-check-input level-checkbox"
                  type="checkbox"
                  value="3"
                  id="level3"
                />
                <label class="form-check-label" for="level3"
                  >Micro Topics</label
                >
              </div>
            </div>
          </div>

          <!-- Graph Statistics -->
          <div class="graph-stats">
            <h6>Graph Statistics</h6>
            <div class="stats-grid">
              <div class="stat-item">
                <span class="stat-label">Total Topics:</span>
                <span class="stat-value" id="totalTopics">-</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Visible Topics:</span>
                <span class="stat-value" id="visibleTopics">-</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Max Depth:</span>
                <span class="stat-value" id="maxDepth">-</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Expanded:</span>
                <span class="stat-value" id="expandedCount">-</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Graph Container -->
        <div class="graph-container">
          <div id="topicGraphContainer" class="cytoscape-container"></div>

          <!-- Loading Overlay -->
          <div id="loadingOverlay" class="loading-overlay">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p>Loading topic graph...</p>
          </div>

          <!-- Error Overlay -->
          <div id="errorOverlay" class="error-overlay" style="display: none">
            <div class="error-content">
              <i class="bi bi-exclamation-triangle"></i>
              <h5>Error Loading Topic Graph</h5>
              <p id="errorMessage">Failed to load topic data.</p>
              <button id="retryButton" class="btn btn-primary">Retry</button>
            </div>
          </div>

          <!-- Graph Controls -->
          <div class="graph-controls">
            <button
              id="fitButton"
              class="btn btn-outline-primary btn-sm"
              title="Fit to view"
            >
              <i class="bi bi-arrows-fullscreen"></i>
            </button>
            <button
              id="centerButton"
              class="btn btn-outline-primary btn-sm"
              title="Center graph"
            >
              <i class="bi bi-bullseye"></i>
            </button>
            <button
              id="expandAllButton"
              class="btn btn-outline-secondary btn-sm"
              title="Expand all"
            >
              <i class="bi bi-plus-square"></i>
            </button>
            <button
              id="collapseAllButton"
              class="btn btn-outline-secondary btn-sm"
              title="Collapse all"
            >
              <i class="bi bi-dash-square"></i>
            </button>
            <button
              id="exportButton"
              class="btn btn-outline-info btn-sm"
              title="Export as image"
            >
              <i class="bi bi-download"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Breadcrumb Navigation -->
      <div class="breadcrumb-container">
        <nav aria-label="Topic navigation">
          <ol class="breadcrumb" id="topicBreadcrumb">
            <li class="breadcrumb-item">
              <a href="#" data-topic="root">All Topics</a>
            </li>
          </ol>
        </nav>
      </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal fade" id="settingsModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Graph Settings</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="nodeSize" class="form-label">Node Size</label>
              <input
                type="range"
                class="form-range"
                id="nodeSize"
                min="0.5"
                max="2"
                step="0.1"
                value="1"
              />
            </div>
            <div class="mb-3">
              <label for="edgeWidth" class="form-label">Edge Width</label>
              <input
                type="range"
                class="form-range"
                id="edgeWidth"
                min="0.5"
                max="3"
                step="0.1"
                value="1"
              />
            </div>
            <div class="mb-3">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="showLabels"
                  checked
                />
                <label class="form-check-label" for="showLabels"
                  >Show Labels</label
                >
              </div>
            </div>
            <div class="mb-3">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="showKeywords"
                  checked
                />
                <label class="form-check-label" for="showKeywords"
                  >Show Keywords</label
                >
              </div>
            </div>
            <div class="mb-3">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="animateTransitions"
                  checked
                />
                <label class="form-check-label" for="animateTransitions"
                  >Animate Transitions</label
                >
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button type="button" class="btn btn-primary" id="applySettings">
              Apply Settings
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
      <div id="notification" class="toast" role="alert">
        <div class="toast-header">
          <i class="bi bi-info-circle me-2"></i>
          <strong class="me-auto">Topic Graph</strong>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="toast"
          ></button>
        </div>
        <div class="toast-body" id="notificationBody">
          <!-- Notification content -->
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="../vendor/bootstrap/bootstrap.bundle.min.js"></script>
    <!-- Topic Graph View JS -->
    <script src="topicGraphView.js"></script>
  </body>
</html>
